<!DOCTYPE html>
<html>
<head>
<title>Tunexa Dashboard - Standalone</title>
<meta charset="UTF-8">
<style>
body{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;font-family:Arial;padding:20px;margin:0;min-height:100vh}
.container{max-width:1000px;margin:0 auto}
h1{text-align:center;font-size:2.5em;margin:20px 0}
.box{background:rgba(255,255,255,0.2);padding:20px;margin:15px 0;border-radius:15px;backdrop-filter:blur(10px)}
.btn{background:rgba(255,255,255,0.3);color:white;padding:12px 20px;border:none;border-radius:25px;cursor:pointer;margin:8px;transition:all 0.3s ease}
.btn:hover{background:rgba(255,255,255,0.5);transform:translateY(-2px)}
.result{background:rgba(0,0,0,0.3);padding:15px;margin:10px 0;border-radius:8px;font-family:monospace;white-space:pre-wrap;display:none}
.status{font-size:1.2em;font-weight:bold}
.online{color:#4ade80}
.offline{color:#f87171}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin:20px 0}
.card{background:rgba(255,255,255,0.15);padding:20px;border-radius:12px;text-align:center;border:1px solid rgba(255,255,255,0.2)}
.card h3{margin:0 0 10px 0;font-size:1.3em}
.card .value{font-size:2em;font-weight:bold;margin:10px 0}
</style>
</head>
<body>
<div class="container">
<h1>üéµ Tunexa Dashboard</h1>
<p style="text-align:center;font-size:1.1em;opacity:0.9">Intelligent Audio Engine - Real-time Monitoring</p>

<div class="grid">
<div class="card">
<h3>üöÄ System Status</h3>
<div class="value online" id="systemStatus">‚óè</div>
<p>Engine Running</p>
</div>
<div class="card">
<h3>üóÑÔ∏è Database</h3>
<div class="value" id="carCount">119</div>
<p>Car Models</p>
</div>
<div class="card">
<h3>üìä Acoustics</h3>
<div class="value" id="acousticsCount">5</div>
<p>Profiles</p>
</div>
<div class="card">
<h3>üîß Modules</h3>
<div class="value" id="moduleCount">6</div>
<p>Active</p>
</div>
</div>

<div class="box">
<h2>üîç System Health Check</h2>
<button class="btn" onclick="checkHealth()">Check API Health</button>
<div id="healthResult" class="result"></div>
</div>

<div class="box">
<h2>üéØ Audio Certification Test</h2>
<p>Test the automotive audio certification system according to ISO standards.</p>
<button class="btn" onclick="testCertification()">Run Certification Test</button>
<div id="certResult" class="result"></div>
</div>

<div class="box">
<h2>üîå OEM Integration Test</h2>
<p>Test connection to vehicle electronic systems via CAN-FD, DoIP, FlexRay protocols.</p>
<button class="btn" onclick="testOEM()">Test Vehicle Connection</button>
<div id="oemResult" class="result"></div>
</div>

<div class="box">
<h2>üé∂ Spotify Integration Test</h2>
<p>Test music streaming integration with audio quality optimization.</p>
<button class="btn" onclick="testSpotify()">Test Spotify API</button>
<div id="spotifyResult" class="result"></div>
</div>

<div class="box">
<h2>üîó Quick Links</h2>
<a href="http://localhost:3000/" target="_blank" class="btn">API Root</a>
<a href="http://localhost:3000/health" target="_blank" class="btn">Health Endpoint</a>
<button class="btn" onclick="refreshAll()">üîÑ Refresh All</button>
</div>

</div>

<script>
const API_BASE = 'http://localhost:3000';

function showResult(elementId, data) {
  const el = document.getElementById(elementId);
  el.style.display = 'block';
  el.textContent = typeof data === 'string' ? data : JSON.stringify(data, null, 2);
}

function hideResult(elementId) {
  document.getElementById(elementId).style.display = 'none';
}

async function makeRequest(endpoint, options = {}) {
  try {
    console.log('Making request to:', API_BASE + endpoint);
    const response = await fetch(API_BASE + endpoint, {
      headers: { 'Content-Type': 'application/json', ...options.headers },
      ...options
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('Request failed:', error);
    return { 
      error: error.message,
      timestamp: new Date().toISOString(),
      endpoint: endpoint
    };
  }
}

async function checkHealth() {
  hideResult('healthResult');
  showResult('healthResult', 'Checking server health...');
  
  const data = await makeRequest('/health');
  showResult('healthResult', data);
  
  // Update status indicator
  const statusEl = document.getElementById('systemStatus');
  if (data.status === 'healthy') {
    statusEl.className = 'value online';
    statusEl.textContent = '‚óè';
  } else {
    statusEl.className = 'value offline';
    statusEl.textContent = '‚óè';
  }
}

async function testCertification() {
  hideResult('certResult');
  showResult('certResult', 'Running audio certification test...');
  
  const data = await makeRequest('/api/audio-certification/certify', {
    method: 'POST',
    body: JSON.stringify({ 
      vehicle: 'BMW 3 Series',
      user: 'demo-user',
      timestamp: new Date().toISOString()
    })
  });
  showResult('certResult', data);
}

async function testOEM() {
  hideResult('oemResult');
  showResult('oemResult', 'Testing OEM vehicle connection...');
  
  const data = await makeRequest('/api/oem-integration/connect', {
    method: 'POST',
    body: JSON.stringify({ 
      protocol: 'CAN-FD',
      vehicle: 'Tesla Model 3',
      timestamp: new Date().toISOString()
    })
  });
  showResult('oemResult', data);
}

async function testSpotify() {
  hideResult('spotifyResult');
  showResult('spotifyResult', 'Testing Spotify integration...');
  
  const data = await makeRequest('/api/spotify-integration');
  showResult('spotifyResult', data);
}

async function refreshAll() {
  await checkHealth();
}

// Auto-check health on page load
window.addEventListener('load', function() {
  setTimeout(checkHealth, 1000);
});

// Auto-refresh every 30 seconds
setInterval(checkHealth, 30000);
</script>

</body>
</html>